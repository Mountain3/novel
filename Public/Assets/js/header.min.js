
jQuery(function(){var params=["param="+encodeURIComponent("typeId=24&cateId=0"),"param="+encodeURIComponent("typeId=97&cateId=0"),"param="+encodeURIComponent("typeId=98&cateId=0")].join("&");jQuery.ajax({url:Domain.bookHostName+"/ajax/recommend.getRecommendData.do",data:params,dataType:"jsonp",success:function(data){var data1=data.recommend24_0;var data2=data.recommend97_0;var data3=data.recommend98_0;if(data1!=null&&data1.recommendDataViewList!=null){var a=[];a[a.length]="<span class=\"qp\"></span>";a[a.length]="<ul>";for(var i=0;i<data1.recommendDataViewList.length;i++){var recommend=data1.recommendDataViewList[i];a[a.length]="<li><a";if(recommend.titleColor!=null){a[a.length]=" style=\"color: "+recommend.titleColor+"\"";}
a[a.length]=" href=\""+recommend.recommendUrl+"\" target=\"_blank\">"+recommend.recommendTitle+"</a></li>";}
a[a.length]="</ul>";jQuery("#sysMessage").html(a.join(""));}
if(data2!=null&&data2.recommendDataViewList!=null){var a=[];for(var i=0;i<data2.recommendDataViewList.length;i++){var recommend=data2.recommendDataViewList[i];a[a.length]="<a";if(recommend.titleColor!=null){a[a.length]=" style=\"color: "+recommend.titleColor+"\"";}
a[a.length]=" href=\""+recommend.recommendUrl+"\" target=\"_blank\">"+recommend.recommendTitle+"</a>";}
jQuery("#commonRecommend1").html(a.join(""));}
if(data3!=null&&data3.recommendDataViewList!=null){if(data3.recommendDataViewList.length>0){var recommend=data3.recommendDataViewList[0];if(recommend.bookName!=null){jQuery("form[name=searchForm] input[name=keyword]").attr("defaultDataValue",recommend.bookName);jQuery("form[name=searchForm] input[name=keyword]").val(recommend.bookName);jQuery("#ui_top_search_dialog input[name=keyword]").attr("defaultDataValue",recommend.bookName);jQuery("#ui_top_search_dialog input[name=keyword]").val(recommend.bookName);}}}}});});jQuery(function(){var parent=jQuery("form[name=searchForm]");parent.find("span.select").click(function(){parent.find("div.listpanel").toggle();});parent.find("div.listpanel").hover(function(){parent.find("div.listpanel").show();},function(){parent.find("div.listpanel").hide();});parent.find("input[name=keyword]").change(function(){if(this.value.replace(/(^\s*)|(\s*$)/g,"")==""){this.value=this.getAttribute("defaultDataValue");}
return false;});parent.find("input[name=keyword]").keydown(function(event){event=(event||window.event);if(event.keyCode==13){parent.find("input.sousuo").click();return false;}
return true;});parent.find("input[name=keyword]").focus(function(event){if(this.value==this.getAttribute("defaultDataValue")){this.value="";}});parent.find("input[name=keyword]").blur(function(event){if(this.value.replace(/(^\s*)|(\s*$)/g,"")==""){this.value=this.getAttribute("defaultDataValue");}});parent.find("ul.selecttext li a").click(function(event){event=(event||window.event);parent.find("input[name=searchType]").val(this.getAttribute("type"));parent.find("span.select").html(this.innerHTML+"<em></em>");parent.find("span.select").click();if(event!=null){if(event.stopPropagation){event.stopPropagation();}else{event.cancelBubble=true;}
if(event.preventDefault){event.preventDefault();}
event.cancel=true;event.returnValue=false;}
return false;});parent.find("input.sousuo").click(function(){var keyword=this.form.keyword.value.replace(/(^\s*)|(\s*$)/g,"");if(keyword!="书名/作者/标签"&&keyword!=""){if(location.host=="search.zongheng.com"){location.href="http://search.zongheng.com/search/"+this.form.searchType.value+"/"+encodeURI(keyword)+"/1.html";}else{window.open("http://search.zongheng.com/search/"+this.form.searchType.value+"/"+encodeURI(keyword)+"/1.html","_blank");}}
return false;});});UserInfoManager.addListener(function(userInfo){if(userInfo==null||userInfo==undefined){return;}
jQuery.ajax({url:Domain.bookHostName+"/ajax/user.footprint.do",processData:false,data:"type="+1,dataType:"jsonp",success:function(data){if(data!=null&&data!=undefined&&data.length>0){jQuery("#read_history").html(UserInfoManager.getReadHistoryHtml(data));jQuery("#historylist").html(UserInfoManager.getReadHistoryListHtml(data));function postClickStat(objurl,objtxt,sign){var isLogin=(CookieUtil.getCookie("logon")!=null)?1:0;var userId=(CookieUtil.getCookie("logon")!=null)?Base64.decode(CookieUtil.getCookie("logon").split("|")[0]):null
new Image().src="http://www.hao123.com/t.gif?pid=201&ih=1&v=pc&pf=1&lo="+isLogin+"&zhId="+userId+"&objurl="+objurl+"&title="+objtxt+"&sg="+sign+"&px="+window.screen.width+","+window.screen.height+"&rnd="+new Date().getTime();}
var statTbarHs=$("#top-user-nav-bar").find("#read_history");var statTbarHsList=$("#top-user-nav-bar").find("#historylist");statTbarHs.find("a").bind("click",function(){postClickStat($(this).attr("href"),$(this).html(),"tbarHs_0");});statTbarHsList.find("a").bind("click",function(){postClickStat($(this).attr("href"),$(this).html(),"tbarHs_ls");});jQuery("#read_history").show();jQuery("#read_history .record").hover(function(){jQuery("#historylist").show();jQuery(this).addClass("current");},function(){jQuery("#historylist").hide();jQuery(this).removeClass("current");});jQuery("#historylist").hover(function(){jQuery(this).show();jQuery("#read_history .record").addClass("current");},function(){jQuery(this).hide();jQuery("#read_history .record").removeClass("current");});}else{jQuery("#read_history").html("您最近的看书历史记录为空");}}});if(UserInfoManager.userInfo.userPasswordStatus==0&&CookieUtil.getCookie("passwarn")!=window.user.userId){passWarn.alertPass();}
if(userInfo!=null&&$("#alertCpass").length==0){bindWarn.open();}});var bindWarn={open:function(){if(!CookieUtil.getCookie("BDP")&&$("body").attr("scriptSign")!="author"&&CookieUtil.getCookie("bindwarn")!="1"){$("body").append('<style>#bind_tips a:hover{text-decoration:none}</style><div id="bind_tips" class="log_reg_box updiv" style="width:420px"><div class="tit"><em class="close closebindtips">关闭</em></div><div style="font-size:16px;line-height:36px;color:#5b5b5b;text-align:center;padding:35px 0 25px">纵横账号支持绑定百度账号了！<br>绑定后可以使用百度账号登录，多平台登录更便捷！</div><div><a href="http://home.zongheng.com/?bind=true" style="float:left;background:#357fea;color:#fff; text-align:center;border-radius:5px;display:inline;margin-left:40px;width:154px;height:40px;font-size:16px;line-height:40px">立即去绑定 &gt;</a><a href="javascript:void(0)" style="float:left;background:#eaeaea;color:#999; text-align:center;border-radius:5px;display:inline;margin-left:37px;width:152px;height:38px;border:1px solid #d9d9d9;font-size:16px;line-height:40px" class="closebindtips">我要看书，别烦我</a></div><div style="height:35px;clear:both"></div></div>');Dialog.open("bind_tips");$(".closebindtips").click(function(){bindWarn.close()});}},close:function(){Dialog.close('bind_tips');CookieUtil.setCookie({name:"bindwarn",value:"1",expires:24*3600,path:"/",domain:".zongheng.com"});}}
var passWarn={alertPass:function(){var a=[];a[a.length]='<style>.alertmsg{width:470px;height:340px;border:1px solid #c4c5c7;background:#fff;}.alertmsg .tipsbg{padding-left:10px;height:34px;line-height:34px;font-weight:bold;color:#333;background:#c4c5c7;font-size:14px;}.alertmsg .tipsbg .tips{padding-left:20px;font-weight:bold;}.alertmsg .tipsbg .close{background:url(http://static.zongheng.com/v2014/images/x.gif) no-repeat;width:14px;height:12px;text-indent:-9999px;float:right;margin:10px 13px 0 0;}.alertmsg .msg{padding:40px 10px 0;}.alertmsg .msg .warn{color:#333;font-weight:bold;font-size:14px;padding-left:30px;}.alertmsg .msg .warn img{vertical-align:middle;padding-right:10px;}.alertmsg .msg .go{border-top:1px dashed #c4c5c7;padding-top:10px;}.alertmsg .msg .go p{color:#333;line-height:22px;padding-left:30px;}.alertmsg .msg .sumitbg{text-align:center;padding-bottom:10px;}.alertmsg .msg .sumitbg a{width:137px;height:35px;font-size:14px;line-height:35px;text-align:center;color:#fff;text-decoration:none;display:inline-block;margin:0 22px;border-radius:2px;}.alertmsg .msg .sumitbg a.done{background:#b32938}.alertmsg .msg .sumitbg a.pro{background:#365260}.alertmsg .msg .info{padding-left:30px;font-size:14px;}</style>'
a[a.length]='<div id="alertCpass" class="alertmsg" style="height:280px;"><p class="tipsbg clear"><span class="close" style="cursor:pointer" onclick="passWarn.alertPassClose();">关闭</span>提示</p><div class="msg"><p class="warn" style="color:#777;font-weight:bold;background:url(http://static.zongheng.com/v2014/images/warn.jpg) no-repeat 35px 10px;padding-left:100px;line-height:35px;text-align:left">您的账号安全系数比较低，为了您的账号安全，<br>请尽快修改密码！</p><div class="cl20"></div><div class="go"></div><div class="cl20"></div><p class="sumitbg"><a class="done" id="payOverlnk" href="http://home.zongheng.com/setting/userPass.do">立即修改</a><a class="pro" id="payErrorlnk" onclick="passWarn.alertPassClose();" style="cursor:pointer">稍后再改</a></p><div class="cl20"></div></div></div>';alertHtml=a.join("");if($("#alertCpass").length==0){$("body").append(alertHtml);}
Dialog.open("alertCpass");},alertPassClose:function(){Dialog.close('alertCpass');CookieUtil.setCookie({name:"passwarn",value:window.user.userId,expires:24*3600,path:"/",domain:".zongheng.com"});}}